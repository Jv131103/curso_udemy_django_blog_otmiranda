                Criando um campo ImageField para Favicon no Django


Em models.py de sitesetup, vamos fazer:

    from django.db import models


# Create your models here.
class MenuLink(models.Model):
    class Meta:
        verbose_name = "Menu Link"
        verbose_name_plural = "Menu Links"

    text = models.CharField(max_length=50)
    url_or_path = models.CharField(max_length=2048)
    new_tab = models.BooleanField(default=False)
    site_setup = models.ForeignKey(
        'SiteSetup',  # Como já fizemos a migração no Django, o tal nos permite fazer isso
        on_delete=models.CASCADE,
        blank=True,
        null=True,
        default=None
    )

    def __str__(self):
        return self.text


class SiteSetup(models.Model):
    class Meta:
        verbose_name = "Setup"
        verbose_name_plural = "Setup"

    title = models.CharField(max_length=65)
    description = models.CharField(max_length=255)
    show_header = models.BooleanField(default=True)
    show_search = models.BooleanField(default=True)
    show_menu = models.BooleanField(default=True)
    show_description = models.BooleanField(default=True)
    show_pagination = models.BooleanField(default=True)
    show_footer = models.BooleanField(default=True)

    faveicon = models.ImageField(
        upload_to='assets/favicon/%Y/%m/',
        blank=True,
        default=""
    )

    def __str__(self):
        return self.title

Provavelmente, ele deve ter dado esse erro aqui:

    ERRORS:
    site_setup.SiteSetup.faveicon: (fields.E210) Cannot use ImageField because Pillow is not installed.
    HINT: Get Pillow at https://pypi.org/project/Pillow/ or run command "python -m pip install Pillow

Para resolver esse erro vamos por parte:

    1 - Em requirements.txt vamos adicionar manualmente o pillow:

        Django>=5.1.7,<5.2
        psycopg2-binary>=2.9.10,<2.10
        Pillow>=9.5.0,<9.6

    2 - Agora, vamos buildar o nosso projeto:

        docker compose up --build

Agora, se formos até templates/_head.html, podemos adicionar uma imagem, mas primeiro, adicione-o
pelo admin.

    <head>
        {% load static %}
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="{% static "blog/css/style.css" %}">
        {% if site_setup.faveicon %}
            <link rel="shortcut icon" href="{{ site_setup.faveicon.url }}" type="image/png">
        {% endif %}
        <title>TESTE</title>
    </head>
